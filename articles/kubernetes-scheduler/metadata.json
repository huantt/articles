{"url":"https://dev.to/jacktt/kubernetes-scheduler-129i","slug":"kubernetes-scheduler","title":"Kubernetes Scheduler","description":"I. Concepts            Node labels   When create a node, we can mark some labels for it. On...","body_markdown":"## I. Concepts\n### Node labels\nWhen create a node, we can mark some labels for it.\nOn AWS nodes are assigned by default some labels such as:\n\n```\nnode.kubernetes.io/instance-type=t3.xlarge\nkubernetes.io/arch=amd64\nnode.kubernetes.io/instance-type=t3.xlarge\n```\n### Node taints\nA node taint lets you mark a node to prevent using it for Pods.\n\nA taint consists of a key, value, and effect.\n\nAvailable effect values:\n\n- NoSchedule\n - New pods that do not match the taint are not scheduled onto that node.\n - Existing pods on the node remain.\n\n- PreferNoSchedule\n - New pods that do not match the taint might be scheduled onto that node, but the scheduler tries not to.\n - Existing pods on the node remain.\n\n- NoExecute\n - New pods that do not match the taint cannot be scheduled onto that node.\n - Existing pods on the node that do not have a matching toleration are removed.\n - Pods that tolerate the taint and specifies `tolerationSeconds` remain bound for the specified amount of time. After that time elapses, this pod will be evicted.\n\n## II. Assigning Pods to Nodes\nThere are 2 main ways to schedule a pod into a specific node:\n\n### 1/ nodeSelector (pod) - node labales (node)\n`spec.nodeSelector` is a map that specific the node labels that this pod want to be deployed on.\n\n### 2/ toleration (pod) - taint (node)\nPods that have suitable toleration with the node's taint will be scheduled to the node. The matching rule includes the matching key, value, and the valid rule of `effect` described above.\n\n## Reference\n- https://www.densify.com/kubernetes-autoscaling/kubernetes-taints/\n- https://kubernetes.io/docs/concepts/scheduling-eviction/taint-and-toleration/\n","body_html":"\u003ch2\u003e\n  \u003ca name=\"i-concepts\" href=\"#i-concepts\"\u003e\n  \u003c/a\u003e\n  I. Concepts\n\u003c/h2\u003e\n\n\u003ch3\u003e\n  \u003ca name=\"node-labels\" href=\"#node-labels\"\u003e\n  \u003c/a\u003e\n  Node labels\n\u003c/h3\u003e\n\n\u003cp\u003eWhen create a node, we can mark some labels for it.\u003cbr\u003e\nOn AWS nodes are assigned by default some labels such as:\u003cbr\u003e\n\u003c/p\u003e\n\n\u003cdiv class=\"highlight js-code-highlight\"\u003e\n\u003cpre class=\"highlight plaintext\"\u003e\u003ccode\u003enode.kubernetes.io/instance-type=t3.xlarge\nkubernetes.io/arch=amd64\nnode.kubernetes.io/instance-type=t3.xlarge\n\u003c/code\u003e\u003c/pre\u003e\n\u003cdiv class=\"highlight__panel js-actions-panel\"\u003e\n\u003cdiv class=\"highlight__panel-action js-fullscreen-code-action\"\u003e\n    \u003csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-on\"\u003e\u003ctitle\u003eEnter fullscreen mode\u003c/title\u003e\n    \u003cpath d=\"M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z\"\u003e\u003c/path\u003e\n\u003c/svg\u003e\n\n    \u003csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-off\"\u003e\u003ctitle\u003eExit fullscreen mode\u003c/title\u003e\n    \u003cpath d=\"M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z\"\u003e\u003c/path\u003e\n\u003c/svg\u003e\n\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\n\n\n\u003ch3\u003e\n  \u003ca name=\"node-taints\" href=\"#node-taints\"\u003e\n  \u003c/a\u003e\n  Node taints\n\u003c/h3\u003e\n\n\u003cp\u003eA node taint lets you mark a node to prevent using it for Pods.\u003c/p\u003e\n\n\u003cp\u003eA taint consists of a key, value, and effect.\u003c/p\u003e\n\n\u003cp\u003eAvailable effect values:\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eNoSchedule\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eNew pods that do not match the taint are not scheduled onto that node.\u003c/li\u003e\n\u003cli\u003eExisting pods on the node remain.\u003c/li\u003e\n\u003c/ul\u003e\n\n\n\u003c/li\u003e\n\u003cli\u003e\n\n\u003cp\u003ePreferNoSchedule\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eNew pods that do not match the taint might be scheduled onto that node, but the scheduler tries not to.\u003c/li\u003e\n\u003cli\u003eExisting pods on the node remain.\u003c/li\u003e\n\u003c/ul\u003e\n\n\n\u003c/li\u003e\n\u003cli\u003e\n\n\u003cp\u003eNoExecute\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eNew pods that do not match the taint cannot be scheduled onto that node.\u003c/li\u003e\n\u003cli\u003eExisting pods on the node that do not have a matching toleration are removed.\u003c/li\u003e\n\u003cli\u003ePods that tolerate the taint and specifies \u003ccode\u003etolerationSeconds\u003c/code\u003e remain bound for the specified amount of time. After that time elapses, this pod will be evicted.\u003c/li\u003e\n\u003c/ul\u003e\n\n\n\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2\u003e\n  \u003ca name=\"ii-assigning-pods-to-nodes\" href=\"#ii-assigning-pods-to-nodes\"\u003e\n  \u003c/a\u003e\n  II. Assigning Pods to Nodes\n\u003c/h2\u003e\n\n\u003cp\u003eThere are 2 main ways to schedule a pod into a specific node:\u003c/p\u003e\n\n\u003ch3\u003e\n  \u003ca name=\"1-nodeselector-pod-node-labales-node\" href=\"#1-nodeselector-pod-node-labales-node\"\u003e\n  \u003c/a\u003e\n  1/ nodeSelector (pod) - node labales (node)\n\u003c/h3\u003e\n\n\u003cp\u003e\u003ccode\u003espec.nodeSelector\u003c/code\u003e is a map that specific the node labels that this pod want to be deployed on.\u003c/p\u003e\n\n\u003ch3\u003e\n  \u003ca name=\"2-toleration-pod-taint-node\" href=\"#2-toleration-pod-taint-node\"\u003e\n  \u003c/a\u003e\n  2/ toleration (pod) - taint (node)\n\u003c/h3\u003e\n\n\u003cp\u003ePods that have suitable toleration with the node's taint will be scheduled to the node. The matching rule includes the matching key, value, and the valid rule of \u003ccode\u003eeffect\u003c/code\u003e described above.\u003c/p\u003e\n\n\u003ch2\u003e\n  \u003ca name=\"reference\" href=\"#reference\"\u003e\n  \u003c/a\u003e\n  Reference\n\u003c/h2\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.densify.com/kubernetes-autoscaling/kubernetes-taints/\"\u003ehttps://www.densify.com/kubernetes-autoscaling/kubernetes-taints/\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://kubernetes.io/docs/concepts/scheduling-eviction/taint-and-toleration/\"\u003ehttps://kubernetes.io/docs/concepts/scheduling-eviction/taint-and-toleration/\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n","thumbnail":"","author":{"id":"jacktt","name":"JackTT"},"created_at":"2024-01-03T02:31:37Z","updated_at":null,"tags":[]}